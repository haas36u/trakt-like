{% extends 'front/base.html.twig' %}

{% block body %}

    <div>
        <div class="row mb-0" style="background-color: black;">

            <div class="col l3 movie_tv_menu">
                <h2>Films</h2>

                <ul class="mb-3">
                    <li><a href="">Les plus populaires</a></li>
                    <li><a href="">Derniers ajouts</a></li>
                </ul>
                <div class="line"></div>
                <form action="" class="mt-4">
                    <select name="" id="">
                        <option value="">Genres</option>
                        <option value="">Action</option>
                        <option value="">Aventure</option>
                        <option value="">Fantastique</option>
                    </select>
                    <div class="input-field col s6">
                        <input type="date">
                    </div>
                    <div class="input-field col s6">
                        <input type="date">
                    </div>
                    <div class="search">
                        <input type="submit" value="Chercher" class="btn">
                    </div>
                </form>

            </div>
            <div class="col l9 p-0 offset-l3">
                {% for movie in movies %}
                    <!-- shortPlot -->
                    <div class="col l4 p-0 movie_vignette card">
                        <div style="background-image: url('{{ movie.poster }}');"></div>
                        <div class="actions_buttons" onclick="location.href='{{ path('movie_show', { 'id': movie.id }) }}'">
                            <div>
                                <i class="small material-icons p-1 right addToWishList" data-movieId="{{ movie.id }}">playlist_add</i>
                                <i class="small material-icons p-1 right addToWatched" data-movieId="{{ movie.id }}">remove_red_eye</i>
                                <i class="small material-icons p-1 right addToFavorite" data-movieId="{{ movie.id }}">favorite</i>
                            </div>
                        </div>
                        <div class="movie_title">
                            <p class="activator">{{ movie.title }} {% if movie.releaseDate %}- {{ movie.releaseDate|date('Y') }}{% endif %}</p>
                            <i class="small material-icons p-1 right activator">more_vert</i>
                        </div>
                        <div class="card-reveal">
                            <span class="card-title gre-text text-darken-4">{{ movie.title }} <i class="material-icons right">close</i> </span>
                            <p>{{ movie.overview }}</p>
                        </div>
                    </div>
                {% endfor %}
                <div class="col l12">
                    <ul class="pagination">
                        <li class="disabled"><a href=""><i class="material-icons">chevron_left</i></a></li>
                        <li class="active"><a href="">1</a></li>
                        <li class="waves-effect"><a href="">2</a></li>
                        <li class="waves-effect"><a href="">3</a></li>
                        <li class="waves-effect"><a href="">4</a></li>
                        <li class="waves-effect"><a href="">5</a></li>
                        <li class="waves-effect"><a href=""><i class="material-icons">chevron_right</i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
        $('.addToFavorite').click(function (e) {
            e.stopPropagation();
            var movieId = $(this).attr('data-movieId');
            $.ajax({
                url:'{{ (path('movie_like')) }}',
                type: "POST",
                dataType: "json",
                data: {
                    "movieId": movieId
                },
                success: function () {
                    if (e.target.style.color === 'red')    e.target.style.color = 'white';
                    else                                   e.target.style.color = 'red';
                }
            });
        });

        $('.addToWatched').click(function (e) {
            e.stopPropagation();
            var movieId = $(this).attr('data-movieId');
            $.ajax({
                url:'{{ (path('movie_watched')) }}',
                type: "POST",
                dataType: "json",
                data: {
                    "movieId": movieId
                },
                success: function () {
                    if (e.target.style.color === 'green')  e.target.style.color = 'white';
                    else                                   e.target.style.color = 'green';
                }
            });
        });

        $('.addToWishList').click(function (e) {
            e.stopPropagation();
            var movieId = $(this).attr('data-movieId');
            $.ajax({
                url:'{{ (path('movie_wish')) }}',
                type: "POST",
                dataType: "json",
                data: {
                    "movieId": movieId
                },
                success: function () {
                    if (e.target.style.color === 'blue')    e.target.style.color = 'white';
                    else                                    e.target.style.color = 'blue';
                }
            });
        });
    </script>
{% endblock %}